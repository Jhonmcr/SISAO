<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <!-- ENCABEZADO: Metadatos, enlaces a CSS y librerías JS externas -->
    <link rel="stylesheet" href="../../../styles/home.css">
    <link rel="stylesheet" href="../../../styles/casos.css">
    <link rel="stylesheet" href="../../../styles/popup.css">
    <link rel="stylesheet" href="../../../styles/popupViewCase.css">
    <link rel="stylesheet" href="../../../styles/logout.css"> <!-- Asegúrate que esta ruta es correcta -->
    <link rel="stylesheet" href="../../../styles/loader.css"> <!-- Indicador de Carga CSS -->
    <link rel="stylesheet" href="../../../styles/jmcr.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <script type="module" src="../../../scripts/export_pdf.js"></script>
    <title>Tabla de Casos</title>
</head>
<body>
    <a href="https://github.com/Jhonmcr" target="_blank" class="jmcr-brand-casos" title="Creado por JMCR">Creado por JMCR</a>
    <!-- INICIO DEL BODY -->

    <!-- NOTIFICACIÓN GLOBAL: Para mostrar mensajes de éxito o error -->
    <p class="notification"></p>

    <!-- CABECERA SUPERIOR: Contiene logos y botones de navegación/acción -->
    <div class="contentEscudos">
        <img src="../../../img/GDCSF.png" class="imgGDC" alt="Logo GDC">
        <div class="contentEscudosSecun">
            <!-- Enlace a la página de inicio -->
            <div class="contentHome">
                <div><img src="../../../img/home.png" class="imgHome" alt="icono de home"></div>
                <a href="../home/home.html">Inicio</a>
            </div>
            <!-- Botón para cerrar sesión -->
            <div>
                <div></div>
                <button class="back-button" id="logoutButton">Cerrar Sesion</button> 
            </div>
        </div>
        <img src="../../../img/GOBIERNO.png" class="imgGOB" alt="Logo de Gobierno">
    </div>

    <!-- TÍTULO DE LA PÁGINA: Sección que muestra el título principal de la vista actual -->
    <div class="contentTitulo">
        <div>
            <!-- Icono SVG representativo de la sección -->
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 4a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v12a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1v-12z" />
                <path d="M3 13h18" />
                <path d="M8 21h8" />
                <path d="M10 17l-.5 4" />
                <path d="M14 17l.5 4" />
            </svg>
        </div>
        <h1>Listado de Casos</h1>
    </div>

    <!-- CONTENEDOR PRINCIPAL DE LA TABLA DE CASOS -->
    <div class="casos-container">
        <h2>Detalle de Casos</h2>

        <!-- SECCIÓN DE FILTROS Y EXPORTACIÓN -->
        <div class="filters-export">
            <!-- Controles de filtrado -->
            <div>
                <label for="filterField">Filtrar por:</label>
                <select id="filterField">
                    <option value="">Todos los campos</option>
                    <option value="id">ID</option>
                    <option value="tipo_obra">Tipo de Obra</option>
                    <option value="parroquia">Parroquia</option>
                    <option value="circuito">Circuito</option>
                    <option value="comuna">Comuna</option>
                    <option value="eje">Eje</option>
                    <option value="month">Mes</option>
                    <option value="caseDate">Fecha de Inicio</option>
                    <option value="fechaEntrega">Fecha de Entrega</option>
                    <option value="estado">Estado de la Obra</option>
                </select>
                <input type="text" id="filterValue" placeholder="Valor a buscar">
                <button id="applyFilterBtn" class="filter-btn">Aplicar Filtro</button>
                <button id="clearFilterBtn" class="filter-btn">Limpiar Filtro</button>
            </div>
            <!-- Botones de exportación -->
            <div>
                <button id="exportBtn" class="export-btn-excel">Exportar a Excel</button>
                <button id="export-pdf-casos" class="export-btn-graficas" disabled>Exportar Gráficas a PDF</button>
            </div>
        </div>

        <!-- CONTENEDOR DE LA TABLA CON SCROLL -->
        <div class="table-scroll-container">
            <table id="casosTable">
                <!-- Encabezados de la tabla -->
                <thead>
                    <tr>
                        <th>COD</th> 
                        <th>Acciones Ejecutadas</th>
                        <th>Tipo de Obra</th>
                        <th>Nombre de Obra</th>
                        <th>Parroquia</th>
                        <th>Circuito</th>
                        <th>Eje</th>
                        <th>Comuna</th>
                        <th>Sala de Autogobierno</th>
                        <th>Fecha de Inicio</th>
                        <th>Fecha de Entrega</th>
                        <th>Fotos</th>
                        <th>Actuaciones</th>
                        <th>Modificaciones</th>
                        <th>Estado de la Obra</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <!-- Cuerpo de la tabla: las filas de datos se insertarán aquí mediante JavaScript -->
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
    <!-- FIN DEL CONTENEDOR PRINCIPAL DE LA TABLA DE CASOS -->

    <!-- POPUP (MODAL) PARA AGREGAR UNA NUEVA ACTUACIÓN A UN CASO -->
    <div id="actuacionPopup" class="actuacion-popup">
        <div class="actuacion-popup-content bg-white p-6 rounded-lg shadow-xl w-96 max-w-sm mx-auto">
            <span class="close-btn block text-right text-gray-500 text-2xl cursor-pointer hover:text-gray-700">&times;</span> <!-- Botón para cerrar el popup -->
            <h2 class="text-xl font-bold mb-4">Agregar Actuación</h2>
            <p class="mb-2">ID de Caso: <strong id="actuacionCaseId"></strong></p> <!-- ID del caso al que se agrega la actuación -->
            <textarea id="newActuacionText" placeholder="Escribe la nueva actuación aquí..." required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 mb-4"></textarea>
            <div class="flex justify-end space-x-3">
                <button id="saveActuacionBtn" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Guardar Actuación</button>
            </div>
        </div>
    </div>
    <!-- FIN DEL POPUP DE AGREGAR ACTUACIÓN -->

    <!-- POPUP (MODAL) PARA CONFIRMAR LA ENTREGA DE UNA OBRA/CASO -->
    <div id="confirmDeliveryPopup" class="confirm-delivery-popup">
        <form class="confirm-delivery-popup-content bg-white p-6 rounded-lg shadow-xl w-96 max-w-sm mx-auto">
            <span class="close-btn block text-right text-gray-500 text-2xl cursor-pointer hover:text-gray-700">&times;</span> <!-- Botón para cerrar el popup -->
            <h2 class="text-xl font-bold mb-4">Confirmar Entrega de Obra</h2>
            <p class="mb-2">ID de Caso: <strong id="deliveryCaseId" class="font-semibold text-blue-700"></strong></p> <!-- ID del caso a entregar -->
            <p class="mb-4 text-gray-700">Para confirmar la entrega de la obra, introduce la clave de seguridad:</p>
            <input type="password" id="securityPasswordInput" placeholder="Clave de seguridad" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 mb-4" autocomplete="current-password">
            <div class="flex justify-end space-x-3">
                <button type="button" class="cancel-btn px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400">Cancelar</button>
                <button type="button" class="confirm-btn px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700">Confirmar</button>
            </div>
        </form>
    </div>
    <!-- FIN DEL POPUP DE CONFIRMAR ENTREGA -->

    <!-- POPUP (MODAL) PARA MODIFICAR UN CASO EXISTENTE -->
    <div id="modifyCasePopup" class="popup">
        <div class="popup-content bg-white p-6 rounded-lg shadow-xl w-full max-w-2xl mx-auto">
            <span class="close">&times;</span>
            <h2 class="popup-title">Modificar Caso</h2>
            <p class="notification"></p>
            
            <form class="divForm" id="caseForm">
                <!-- Columna izquierda del formulario -->
                <div class="divFormA">
                    <div>
                        <label for="acciones_ejecutadas">Acciones Ejecutadas</label>
                        <select name="acciones_ejecutadas" id="acciones_ejecutadas" multiple required>

                        </select>
                    </div>

                    <div>
                        <label for="tipo_obra">Tipo de Obra</label>
                        <input type="text" id="tipo_obra" name="tipo_obra" placeholder="Tipo de Obra" required>
                    </div>

                    <div>
                        <label for="nombre_obra">Nombre de la Obra</label>
                        <input type="text" id="nombre_obra" name="nombre_obra" placeholder="Nombre de la Obra" required>
                    </div>

                    <div>
                        <label for="circuito">Circuito</label>
                        <select name="circuito" id="circuito" disabled required>
                            <option value="">Circuito asignado automáticamente</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="parroquia">Parroquia</label>
                        <select name="parroquia" id="parroquia" required>
                            <option value="">Selecciona una Parroquia</option>
                        </select>
                    </div>

                    <div>
                        <label for="comuna">Comúna</label>
                        <select id="comuna" name="comuna" required>
                            <option value="">Seleccione una Comúna</option>
                        </select>
                    </div>

                    <div>
                        <label for="codigoComuna">Código de Comúna</label>
                        <input type="text" id="codigoComuna" name="codigoComuna" placeholder="Código de Comúna" disabled required>
                    </div>

                    <div>
                        <label for="consejo_comunal_ejecuta">Consejo Comunal Donde se Ejecuta la Acción</label>
                        <select id="consejo_comunal_ejecuta" name="consejo_comunal_ejecuta" disabled required>
                            <option value="">Seleccione un Consejo Comunal</option>
                        </select>
                    </div>

                    <div>
                        <label for="codigo_consejo_comunal">Código del Consejo Comunal</label>
                        <input type="text" id="codigo_consejo_comunal" name="codigo_consejo_comunal" placeholder="Código del Consejo Comunal" disabled required>
                    </div>

                    <div>
                        <label for="eje">Eje</label>
                        <select name="eje" id="eje" required>
                            <option value="">Selecciona un Eje</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                    </div>

                    <div>
                        <label for="direccion_exacta">Dirección Exacta</label>
                        <input type="text" id="direccion_exacta" name="direccion_exacta" placeholder="Dirección Exacta" required>
                    </div>

                    <div>
                        <label for="cantidad_familiares">Cantidad de Familias</label>
                        <input type="number" id="cantidad_familiares" name="cantidad_familiares" placeholder="Ingrese la cantidad" required>
                    </div>

                    <div>
                        <label for="jefe_calle">Jefe(a) de Calle</label>
                        <input type="text" id="jefe_calle" name="jefe_calle" placeholder="Jefe de Calle" required>
                    </div>

                    <div>
                        <label for="jefe_politico_eje">Jefe(a) Político del Eje</label>
                        <input type="text" id="jefe_politico_eje" name="jefe_politico_eje" placeholder="Jefe Político del Eje" required>
                    </div>

                    <div>
                        <label for="jefe_juventud_circuito_comunal">Jefe(a) de la Juventud del Circuito Comunal</label>
                        <input type="text" id="jefe_juventud_circuito_comunal" name="jefe_juventud_circuito_comunal" placeholder="Jefe de la Juventud" required>
                    </div>

                    <div>
                        <label for="nameJU">Jefe(a) de UBCH</label>
                        <input type="text" id="nameJU" name="nameJU" placeholder="Nombre y Apellido" required>
                    </div>

                    <div>
                        <label for="nameJC">Jefe(a) de Comunidad</label>
                        <input type="text" id="nameJC" name="nameJC" placeholder="Nombre y Apellido" required>
                    </div>

                    <div>
                        <label for="responsable_sala_autogobierno">Responsable de la Sala de Autogobierno</label>
                        <input type="text" id="responsable_sala_autogobierno" name="responsable_sala_autogobierno" placeholder="Responsable Sala Autogobierno" required>
                    </div>

                    <div>
                        <label for="ente_responsable">Ente Responsable</label>
                        <input type="text" id="ente_responsable" name="ente_responsable" placeholder="Ente Responsable" required>
                    </div>

                    <div>
                        <label for="gerente_responsable">Gerente Responsable</label>
                        <input type="text" id="gerente_responsable" name="gerente_responsable" placeholder="Gerente Responsable" required>
                    </div>

                    <div>
                        <label for="enlace_politico_circuito">Enlace Político del Circuito</label>
                        <input type="text" id="enlace_politico_circuito" name="enlace_politico_circuito" placeholder="Enlace Político del Circuito" required>
                    </div>

                    <div>
                        <label for="enlace_politico_parroquial">Enlace Político Parroquial</label>
                        <input type="text" id="enlace_politico_parroquial" name="enlace_politico_parroquial" placeholder="Enlace Político Parroquial" required>
                    </div>

                    <div>
                        <label for="jueces_de_paz">Juez o jueces de Paz</label>
                        <input type="text" id="jueces_de_paz" name="jueces_de_paz" placeholder="Juez o jueces de Paz" required>
                    </div>

                </div>
                <!-- Columna derecha del formulario -->
                <div class="divFormB">
                    <div class="divPuntoYCirculo">
                        <label for="punto_y_circulo">Punto y Circulo</label>
                        <br>
                        <div>
                            <div>
                                <div>
                                    <input type="radio" id="punto_y_circulo_no" name="punto_y_circulo" value="no" checked required>
                                    <label for="punto_y_circulo_no">No</label>
                                </div>
                                
                                <div>
                                    <input type="radio" id="punto_y_circulo_si" name="punto_y_circulo" value="si" required>
                                    <label for="punto_y_circulo_si">Sí</label>
                                </div>
                            </div>

                            <div id="punto_y_circulo_options" style="display: none;">
                                <label for="punto_y_circulo_count">Cantidad</label>
                                <select name="punto_y_circulo_count" id="punto_y_circulo_count">
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div id="punto_y_circulo_data_container"></div>

                    <div>
                        <label for="estado">Estado de la Obra</label>
                        <select name="estado" id="estado" required>
                            <option value="OBRA EN PROYECCION" selected>OBRA EN PROYECCION</option>
                            <option value="OBRA EN EJECUCION">OBRA EN EJECUCION</option>
                            <option value="OBRA EJECUTADA">OBRA EJECUTADA</option>
                            <option value="OBRA CULMINADA">OBRA CULMINADA</option>
                        </select>
                    </div>

                    <div>
                        <label for="enlaceComunal">Enlace Comunal</label>
                        <input type="text" id="enlaceComunal" name="enlaceComunal" placeholder="Datos del Enlace Comunal" required>
                    </div>

                    <div>
                        <label for="caseDescription">Descripción del Caso</label>
                        <textarea id="caseDescription" name="caseDescription" placeholder="Escribe los detalles de esta nueva obra" required></textarea>
                    </div>

                    <!-- Sección para fecha y carga de archivo -->
                    <div class="fechFile">
                        <div class="fechFile">
                            <div>
                                <label for="caseDate">Fecha de Inicio</label>
                                <input type="date" id="caseDate" name="caseDate" required>
                            </div>

                            <div>
                                <label for="fecha_entrega">Fecha de Entrega</label>
                                <input type="date" id="fecha_entrega" name="fecha_entrega">
                            </div>
                        </div>
                    </div>
                    <div class="divFile">
                        <label>Archivo PDF Actual:</label>
                        <span id="current_archivo" class="current-file-span"></span>
                        <label for="archivo">Subir Nuevo Archivo PDF (Opcional)</label>
                        <input type="file" id="archivo" name="archivo" accept=".pdf">
                    </div>
                </div>
                
                <div class="divBtn">
                    <!-- Botón de envío del formulario -->
                    <button class="btnPopup" type="button" id="submitCaseBtn">GUARDAR CAMBIOS</button>
                </div>
            </form>
        </div>
    </div>
    <!-- FIN DEL POPUP DE MODIFICAR CASO -->

    <!-- POPUP (MODAL) PARA VER LOS DETALLES DE UN CASO (SOLO LECTURA) -->
    <div id="viewCasePopup" class="popup">
        <div class="popup-content">
            <span class="close">&times;</span>
            <h2 class="popup-title">Ver Caso</h2>
            <p class="notification"></p>
            
            <form class="divForm" id="caseForm">
                <!-- Columna izquierda del formulario -->
                <div class="divFormA">
                    <div>
                        <label for="acciones_ejecutadas">Acciones Ejecutadas</label>
                        <select name="acciones_ejecutadas" id="acciones_ejecutadas" multiple required>

                        </select>
                    </div>

                    <div>
                        <label for="tipo_obra">Tipo de Obra</label>
                        <input type="text" id="tipo_obra" name="tipo_obra" placeholder="Tipo de Obra" required>
                    </div>

                    <div>
                        <label for="nombre_obra">Nombre de la Obra</label>
                        <input type="text" id="nombre_obra" name="nombre_obra" placeholder="Nombre de la Obra" required>
                    </div>

                    <div>
                        <label for="circuito">Circuito</label>
                        <select name="circuito" id="circuito" disabled required>
                            <option value="">Circuito asignado automáticamente</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="parroquia">Parroquia</label>
                        <select name="parroquia" id="parroquia" required>
                            <option value="">Selecciona una Parroquia</option>
                        </select>
                    </div>

                    <div>
                        <label for="comuna">Comúna</label>
                        <select id="comuna" name="comuna" required>
                            <option value="">Seleccione una Comúna</option>
                        </select>
                    </div>

                    <div>
                        <label for="codigoComuna">Código de Comúna</label>
                        <input type="text" id="codigoComuna" name="codigoComuna" placeholder="Código de Comúna" disabled required>
                    </div>

                    <div>
                        <label for="consejo_comunal_ejecuta">Consejo Comunal Donde se Ejecuta la Acción</label>
                        <select id="consejo_comunal_ejecuta" name="consejo_comunal_ejecuta" disabled required>
                            <option value="">Seleccione un Consejo Comunal</option>
                        </select>
                    </div>

                    <div>
                        <label for="codigo_consejo_comunal">Código del Consejo Comunal</label>
                        <input type="text" id="codigo_consejo_comunal" name="codigo_consejo_comunal" placeholder="Código del Consejo Comunal" disabled required>
                    </div>

                    <div>
                        <label for="eje">Eje</label>
                        <select name="eje" id="eje" required>
                            <option value="">Selecciona un Eje</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                    </div>

                    <div>
                        <label for="direccion_exacta">Dirección Exacta</label>
                        <input type="text" id="direccion_exacta" name="direccion_exacta" placeholder="Dirección Exacta" required>
                    </div>

                    <div>
                        <label for="cantidad_familiares">Cantidad de Familias</label>
                        <input type="number" id="cantidad_familiares" name="cantidad_familiares" placeholder="Ingrese la cantidad" required>
                    </div>

                    <div>
                        <label for="jefe_calle">Jefe(a) de Calle</label>
                        <input type="text" id="jefe_calle" name="jefe_calle" placeholder="Jefe de Calle" required>
                    </div>

                    <div>
                        <label for="jefe_politico_eje">Jefe(a) Político del Eje</label>
                        <input type="text" id="jefe_politico_eje" name="jefe_politico_eje" placeholder="Jefe Político del Eje" required>
                    </div>

                    <div>
                        <label for="jefe_juventud_circuito_comunal">Jefe(a) de la Juventud del Circuito Comunal</label>
                        <input type="text" id="jefe_juventud_circuito_comunal" name="jefe_juventud_circuito_comunal" placeholder="Jefe de la Juventud" required>
                    </div>

                    <div>
                        <label for="nameJU">Jefe(a) de UBCH</label>
                        <input type="text" id="nameJU" name="nameJU" placeholder="Nombre y Apellido" required>
                    </div>

                    <div>
                        <label for="nameJC">Jefe(a) de Comunidad</label>
                        <input type="text" id="nameJC" name="nameJC" placeholder="Nombre y Apellido" required>
                    </div>

                    <div>
                        <label for="responsable_sala_autogobierno">Responsable de la Sala de Autogobierno</label>
                        <input type="text" id="responsable_sala_autogobierno" name="responsable_sala_autogobierno" placeholder="Responsable Sala Autogobierno" required>
                    </div>

                    <div>
                        <label for="ente_responsable">Ente Responsable</label>
                        <input type="text" id="ente_responsable" name="ente_responsable" placeholder="Ente Responsable" required>
                    </div>

                    <div>
                        <label for="gerente_responsable">Gerente Responsable</label>
                        <input type="text" id="gerente_responsable" name="gerente_responsable" placeholder="Gerente Responsable" required>
                    </div>

                    <div>
                        <label for="enlace_politico_circuito">Enlace Político del Circuito</label>
                        <input type="text" id="enlace_politico_circuito" name="enlace_politico_circuito" placeholder="Enlace Político del Circuito" required>
                    </div>

                    <div>
                        <label for="enlace_politico_parroquial">Enlace Político Parroquial</label>
                        <input type="text" id="enlace_politico_parroquial" name="enlace_politico_parroquial" placeholder="Enlace Político Parroquial" required>
                    </div>

                    <div>
                        <label for="jueces_de_paz">Juez o jueces de Paz</label>
                        <input type="text" id="jueces_de_paz" name="jueces_de_paz" placeholder="Juez o jueces de Paz" required>
                    </div>

                </div>
                <!-- Columna derecha del formulario -->
                <div class="divFormB">
                    <div class="divPuntoYCirculo">
                        <label for="punto_y_circulo">Punto y Circulo</label>
                        <br>
                        <div>
                            <div>
                                <div>
                                    <input type="radio" id="punto_y_circulo_no" name="punto_y_circulo" value="no" checked required>
                                    <label for="punto_y_circulo_no">No</label>
                                </div>
                                
                                <div>
                                    <input type="radio" id="punto_y_circulo_si" name="punto_y_circulo" value="si" required>
                                    <label for="punto_y_circulo_si">Sí</label>
                                </div>
                            </div>

                            <div id="punto_y_circulo_options" style="display: none;">
                                <label for="punto_y_circulo_count">Cantidad</label>
                                <select name="punto_y_circulo_count" id="punto_y_circulo_count">
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div id="punto_y_circulo_data_container"></div>

                    <div>
                        <label for="estado">Estado de la Obra</label>
                        <select name="estado" id="estado" required>
                            <option value="OBRA EN PROYECCION" selected>OBRA EN PROYECCION</option>
                            <option value="OBRA EN EJECUCION">OBRA EN EJECUCION</option>
                            <option value="OBRA EJECUTADA">OBRA EJECUTADA</option>
                            <option value="OBRA CULMINADA">OBRA CULMINADA</option>
                        </select>
                    </div>

                    <div>
                        <label for="enlaceComunal">Enlace Comunal</label>
                        <input type="text" id="enlaceComunal" name="enlaceComunal" placeholder="Datos del Enlace Comunal" required>
                    </div>

                    <div>
                        <label for="caseDescription">Descripción del Caso</label>
                        <textarea id="caseDescription" name="caseDescription" placeholder="Escribe los detalles de esta nueva obra" required></textarea>
                    </div>

                    <!-- Sección para fecha y carga de archivo -->
                    <div class="fechFile">
                        <div class="fechFile">
                            <div>
                                <label for="caseDate">Fecha de Inicio</label>
                                <input type="date" id="caseDate" name="caseDate" required>
                            </div>

                            <div>
                                <label for="fecha_entrega">Fecha de Entrega</label>
                                <input type="date" id="fecha_entrega" name="fecha_entrega">
                            </div>
                        </div>
                    </div>
                    <div class="divFile">
                        <label>Archivo PDF Actual:</label>
                        <span id="current_archivo" class="current-file-span"></span>
                        <label for="archivo">Subir Nuevo Archivo PDF (Opcional)</label>
                        <input type="file" id="archivo" name="archivo" accept=".pdf">
                    </div>
                </div>
                
                <div class="divBtn">
                    <!-- Botón de envío del formulario -->
                    <button class="btnPopup" type="button" id="submitCaseBtn" style="display: none;">CARGAR</button>
                </div>
            </form>
        </div>
    </div>
    <!-- FIN DEL POPUP DE VER CASO -->

    <!-- POPUP (MODAL) PARA VER EL HISTORIAL DE MODIFICACIONES DE UN CASO -->
    <div id="viewModificacionesPopup" class="popup">
        <div class="popup-content bg-white p-6 rounded-lg shadow-xl w-full max-w-lg mx-auto">
            <span class="close">&times;</span> <!-- Botón para cerrar el popup -->
            <h2 class="text-xl font-bold mb-4">Historial de Modificaciones del Caso: <span id="viewModificacionesCaseId" class="font-semibold text-blue-700"></span></h2>
            <ul id="viewModificacionesList" class="modificaciones-list space-y-2 text-gray-800">
                <!-- Lista de modificaciones se cargará aquí dinámicamente -->
            </ul>
        </div>
    </div>
    <!-- FIN DEL POPUP DE VER MODIFICACIONES -->

    <!-- POPUP (MODAL) DE CONFIRMACIÓN PARA ELIMINAR UN CASO -->
    <div id="confirmDeletePopup" class="popup">
        <form class="confirm-delivery-popup-content bg-white p-6 rounded-lg shadow-xl w-96 max-w-sm mx-auto">
            <span class="close block text-right text-gray-500 text-2xl cursor-pointer hover:text-gray-700">&times;</span> <!-- Botón para cerrar el popup -->
            <h2 class="text-xl font-bold mb-4 text-red-600">Confirmar Eliminación de Caso</h2>
            <p class="mb-2">ID de Caso: <strong id="deleteCaseIdDisplay" class="font-semibold text-blue-700"></strong></p>
            <p class="mb-4 text-gray-700">Para confirmar la eliminación del caso, introduce la clave de seguridad:</p>
            <input type="password" id="deleteSecurityPasswordInput" placeholder="Clave de seguridad" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 mb-4" autocomplete="current-password">
            <div class="borrar-btns">
                <button type="button" class="cancel-btn px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400">Cancelar</button>
                <button type="button" class="confirm-btn px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">Eliminar</button>
            </div>
        </form>
    </div>
    <!-- FIN DEL POPUP DE CONFIRMACIÓN DE ELIMINACIÓN -->

    <!-- POPUP (MODAL) DE CONFIRMACIÓN PARA CERRAR SESIÓN -->
    <div id="logoutConfirmModal" class="modal"> 
        <div class="modal-content"> 
            <span class="close-button" onclick="closeModal('logoutConfirmModal')">&times;</span> <!-- Botón para cerrar el popup -->
            <h2>¿Estás seguro que quieres cerrar sesión?</h2>
            <p>Al cerrar sesión, tendrás que volver a iniciarla para acceder al contenido.</p>
            <div class="button-group">
                <button class="confirm-btn" id="confirmLogoutBtn">Sí, cerrar sesión</button>
                <button class="cancel-btn" onclick="closeModal('logoutConfirmModal')">No, quedarse</button>
            </div>
        </div>
    </div>

    <!-- POPUP DE VER ACTUACIONES -->
    <div id="viewActuacionesPopup" class="popup">
        <div class="popup-content bg-white p-6 rounded-lg shadow-xl w-full max-w-lg mx-auto">
            <!-- Eliminado onclick, ahora se adjunta listener por JS -->
            <span class="close">&times;</span>
            <h2 class="text-xl font-bold mb-4">Actuaciones del Caso: <span id="viewActuacionesCaseId" class="font-semibold text-blue-700"></span></h2> 
            <ul id="viewActuacionesList" class="actuaciones-list space-y-2 text-gray-800">
                <!-- Las actuaciones se insertarán aquí por JavaScript -->
            </ul>
    </div>

    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script type="module" src="../../../scripts/utils.js"></script>
    <script type="module" src="../../../scripts/loader.js"></script> <!-- Indicador de Carga JS -->
    <script type="module" src="../../../scripts/popup_handler.js"></script>
    <script type="module" src="../../../scripts/home/select_populator.js"></script>
    <script type="module" src="../../../scripts/caseTableManager.js"></script>
    <script type="module" src="../../../scripts/filterAndExport.js"></script>
    <script type="module" src="../../../scripts/main.js"></script>
    <script type="module" src="../../../scripts/sesion/auth.js"></script> 
    <script type="module" src="../../../scripts/sesion/logout.js"></script>
    <!-- FIN DE SCRIPTS JS -->
</body>
</html>